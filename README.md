# Zero Shot Root Cause Analysis on Microservices

## Overview
This research project, conducted by Pranay Sood and Gayathiri Elambooranan under the supervision of Dr. Yan Liu, investigates the application of large language models (LLMs) for zero-shot root cause analysis (RCA) in microservice environments. Utilizing the PetShop Dataset, this project aims to identify both the root cause node and the target node of anomalies in a microservices architecture without prior specific training.

## Features
- **Data-Driven Insights**: Leverage the PetShop Dataset to simulate real-world microservice performance issues.
- **Dual Model Analysis**: Utilize both traditional models and LLMs for comprehensive RCA.
- **Zero-Shot Learning**: Assess model performance without specific prior training.
- **Systematic Evaluation**: Evaluate responses generated by LLMs for accuracy and effectiveness.

## Project Workflow

### 1. Data Flow
- **Original Issue Identification**: Begin with 68 documented issues.
- **Data Processing**: Transform issues into a suitable format for analysis, resulting in the "Transformed 68 Issues" file.

### 2. Analytical Process
- **MAD Score Computation**: Calculate Mean Absolute Deviation (MAD) scores for each issue.
- **Dependency Information Retrieval**: Extract essential dependency information.
- **Top-N Selection**: Select the most critical issues based on MAD scores for detailed analysis.

### 3. Model Execution
- **Traditional Models**: Generate prompts and analyze using traditional models.
- **LLMs**: Generate hypotheses using LLMs, including root and target node identification.

### 4. Evaluation
- **Traditional Model Evaluation**: Verify root cause identification against standards.
- **LLM Evaluation**: Assess accuracy and connectivity using dependency graphs.

## Data Setup
Download the PetShop Dataset from [here](https://github.com/amazon-science/petshop-root-cause-analysis) and place it in the `dataset/` directory.

## Installation
1. Clone the repository:
    ```bash
    git clone https://github.com/pranaysood/Root-Cause-Analysis.git
    cd Root-Cause-Analysis
    ```
2. Install the required libraries:
    ```bash
    pip install -r requirements.txt
    ```

## Usage
1. **Prepare the Data**:
    ```bash
    python Datametrics_Preprocessing.py
    ```
2. **Run the Analysis**:
    ```bash
    python run_llm.py
    ```
3. **Evaluate the Models**:
    ```bash
    python Path_Based_Evaluation.py
    ```

## Methodology
### LLM Methodology
- **Data Preparation**: Load metrics and service dependencies.
- **Anomaly Detection Using MAD**: Compute MAD for service metrics and identify anomalies.
- **Model Interaction**: Generate prompts and hypotheses using LLMs.
- **Results**: Extract keywords and analyze root causes.

### Traditional Models
- **Epsilon Diagnosis**
- **Bayesian Inference**
- **Root Cause Discovery**

## Evaluation
- **Root Cause Analysis Accuracy**: Evaluate both LLM and traditional model performance.
- **Comparative Analysis**: Compare LLM and traditional models based on their ability to accurately identify root causes.

## Results
- **Detailed CSV Output**: Results include service details, MAD scores, prompts, hypotheses, and keywords.
- **Visualization**: Charts and graphs to illustrate model performance and evaluation.

## Research Goals
- **Optimize Data for LLMs**: Refine and structure datasets for optimal use with large language models.
- **Implement Zero-Shot Learning**: Explore the effectiveness of zero-shot learning using LLMs and traditional models.
- **Evaluate Model Performance**: Conduct systematic evaluations to assess accuracy and applicability in cloud incident management scenarios.

## Contributions
Contributions are welcome! Here's how you can contribute:
- **Issues**: Report bugs or suggest features.
- **Pull Requests**: Fork the repository, make your changes, and submit a pull request.
- **Feedback**: Provide feedback on model usage and suggest improvements.

## Credits
- **Supervisor**: Dr. Yan Liu
- **Researchers and Developers**: Gayathiri Elambooranan, Pranay Sood
- **Dataset**: PetShop Dataset Authors

## Contact
For more information or inquiries, please contact [Pranay Sood](https://www.linkedin.com/in/pranaysood).

---

Â© 2024 Pranay Sood.
